---
import ChatMessage from "../../../components/chat/ChatMessage.astro"
import {isHtmxRequest} from "../../../utils";
import { allowedUserInputs, defaultInput } from "../../../chatConfig";

export const prerender = false

if (!isHtmxRequest(Astro.request)) {
    return Astro.redirect('/')
}

let userInputFromFormData = (await Astro.request.formData()).get('user_input')
let finalUserInput = allowedUserInputs.includes(userInputFromFormData) ? userInputFromFormData : defaultInput
---
<ChatMessage sender='user' text={finalUserInput}/>
